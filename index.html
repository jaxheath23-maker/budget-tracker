<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Personal Finance Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>

<style>
body{font-family:system-ui;background:#f4f6fb;margin:0;color:#222}
header{background:#4f46e5;color:#fff;padding:16px;text-align:center;font-size:20px}
nav{display:flex;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.1)}
nav button{flex:1;padding:14px;border:none;background:none;font-size:15px;cursor:pointer}
nav button.active{border-bottom:4px solid #4f46e5;font-weight:bold}
section{display:none;padding:16px}
section.active{display:block}
.card{background:#fff;border-radius:14px;padding:14px;margin-bottom:14px;box-shadow:0 4px 10px rgba(0,0,0,.05)}
input,select{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid #ccc}
.over{border-left:6px solid #e74c3c}
.good{border-left:6px solid #2ecc71}
button.action{background:#4f46e5;color:#fff;border:none;padding:10px;border-radius:10px;width:100%;margin-top:8px;cursor:pointer}
</style>
</head>

<body>

<header>ðŸ’° Personal Finance Dashboard</header>

<nav>
<button onclick="showTab('budget')" class="active">Budget</button>
<button onclick="showTab('calendar')">Calendar</button>
<button onclick="showTab('settings')">Settings</button>
</nav>

<!-- BUDGET TAB -->
<section id="budget" class="active">
<div id="budgetItems"></div>
<div class="card">
<p><strong>Remaining:</strong> $<span id="remaining">0</span></p>
</div>
</section>

<!-- CALENDAR TAB -->
<section id="calendar">
<div class="card">
<h3>Add Bill or Payday</h3>
<input id="eventName" placeholder="Name (Rent, Payday, etc.)">
<select id="eventType">
<option value="bill">Bill</option>
<option value="pay">Payday</option>
</select>
<input type="date" id="eventDate">
<button class="action" onclick="addEvent()">Add</button>
</div>
<div id="eventList"></div>
</section>

<!-- SETTINGS TAB -->
<section id="settings">
<div class="card">
<h3>Cloud Sync</h3>
<p>Paste your Firebase keys below to enable sync.</p>
<button class="action" onclick="syncToCloud()">Sync to Cloud</button>
<button class="action" onclick="loadFromCloud()">Load from Cloud</button>
</div>
<div class="card">
<button class="action" onclick="resetAll()">Reset All Data</button>
</div>
</section>

<script>
// =========================
// CONFIGURE FIREBASE HERE
// =========================
const firebaseConfig = {
  apiKey: "AIzaSyA4jQd6f-cRohCObgRyscM3brEbQkiEZ3o",
  authDomain: "budget-3582e.firebaseapp.com",
  projectId: "budget-3582e",
  storageBucket: "budget-3582e.firebasestorage.app",
  messagingSenderId: "889532008400",
  appId: "1:889532008400:web:d174a40803e39c90b29bd5",
  measurementId: "G-3JER9KVEX0"
};

// Uncomment the next two lines after pasting your Firebase keys
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// =========================
// APP STATE
// =========================
let state = JSON.parse(localStorage.getItem("finance")) || {
items:[
{name:"Savings Transfer",budget:350,spent:0},
{name:"Groceries",budget:150,spent:0},
{name:"Gas",budget:100,spent:0},
{name:"Other Spending",budget:100,spent:0},
{name:"Phone",budget:100,spent:0},
{name:"Insurance",budget:180,spent:0},
{name:"Loan Payment",budget:200,spent:0},
{name:"Subscriptions",budget:75,spent:0}
],
events:[]
};

function saveLocal(){localStorage.setItem("finance",JSON.stringify(state));}

// =========================
// TAB SWITCHING
// =========================
function showTab(id){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
document.getElementById(id).classList.add("active");
document.querySelector(`nav button[onclick*="${id}"]`).classList.add("active");
}

// =========================
// BUDGET FUNCTIONS
// =========================
function renderBudget(){
let remaining=0;
const c=document.getElementById("budgetItems");
c.innerHTML="";
state.items.forEach(i=>{
remaining+=i.budget-i.spent;
const d=document.createElement("div");
d.className="card "+(i.spent>i.budget?"over":"good");
d.innerHTML=`
<strong>${i.name}</strong>
<label>Budget</label>
<input type="number" value="${i.budget}" onchange="updateBudget('${i.name}',this.value)">
<label>Spent</label>
<input type="number" value="${i.spent}" onchange="updateSpent('${i.name}',this.value)">
${i.spent>i.budget?"ðŸš¨ Over budget":""}
`;
c.appendChild(d);
});
document.getElementById("remaining").textContent=remaining;
}

function updateBudget(name,val){
state.items.find(i=>i.name===name).budget=Number(val);
saveLocal();
renderBudget();
}

function updateSpent(name,val){
const i=state.items.find(x=>x.name===name);
i.spent=Number(val);
if(i.spent>i.budget) alert(name+" is over budget");
saveLocal();
renderBudget();
}

// =========================
// CALENDAR FUNCTIONS
// =========================
function addEvent(){
state.events.push({
name:eventName.value,
type:eventType.value,
date:eventDate.value
});
saveLocal();
renderEvents();
eventName.value="";
eventDate.value="";
}

function renderEvents(){
const l=document.getElementById("eventList");
l.innerHTML="";
state.events.forEach(e=>{
const d=document.createElement("div");
d.className="card";
d.innerHTML=`<strong>${e.date}</strong><br>${e.name} (${e.type})`;
l.appendChild(d);
});
}

// =========================
// CLOUD SYNC FUNCTIONS
// =========================
async function syncToCloud(){
try {
  await db.collection("finance").doc("main").set(state);
  alert("Synced to cloud");
} catch(err){alert("Error syncing to cloud: "+err);}
}

async function loadFromCloud(){
try {
  const doc = await db.collection("finance").doc("main").get();
  if(doc.exists){
    state = doc.data();
    saveLocal();
    renderBudget();
    renderEvents();
    alert("Loaded from cloud");
  } else {
    alert("No cloud data found.");
  }
} catch(err){alert("Error loading cloud data: "+err);}
}

// =========================
// RESET
// =========================
function resetAll(){
if(confirm("Reset all data?")){
localStorage.clear();
location.reload();
}
}

// =========================
// INITIAL RENDER
// =========================
renderBudget();
renderEvents();
</script>

</body>
</html>
